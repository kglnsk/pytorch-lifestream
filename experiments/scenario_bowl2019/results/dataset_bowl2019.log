load_source_data       : Loaded 11341042 rows from "/mnt/data/ovsov/dltranz/experiments/scenario_bowl2019/data/train.csv"
load_source_data       : Loaded 1156414 rows from "/mnt/data/ovsov/dltranz/experiments/scenario_bowl2019/data/test.csv"
load_source_data       : Loaded 12497456 rows in total
trx_to_features        : Found 18000 unique clients
_td_datetime_string    : To-float time transformation
_init_num_threads      : Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
_init_num_threads      : NumExpr defaulting to 8 threads.
trx_to_features        : Encoder stat for "event_id":
codes | trx_count
                cnt  % of total
event_id                       
[1, 33)     5381714    0.430625
[33, 65)    2647661    0.211856
[65, 97)    1557148    0.124597
[97, 129)   1066010    0.085298
[129, 161)   660785    0.052874
[161, 193)   430971    0.034485
[193, 225)   283534    0.022687
[225, 257)   199883    0.015994
[257, 290)   141435    0.011317
[290, 385)   128315    0.010267
trx_to_features        : Encoder stat for "event_code":
codes | trx_count
                cnt  % of total
event_code                     
[1, 4)      5800049    0.464098
[4, 7)      3239759    0.259233
[7, 11)     1330623    0.106472
[11, 14)     859644    0.068786
[14, 17)     567943    0.045445
[17, 21)     264592    0.021172
[21, 24)     108863    0.008711
[24, 27)      92982    0.007440
[27, 31)      92962    0.007438
[31, 43)     140039    0.011205
trx_to_features        : Encoder stat for "event_type":
codes | trx_count
                cnt  % of total
event_type                     
[1, 2)      6367553    0.509508
[2, 3)      4903002    0.392320
[3, 4)      1027972    0.082255
[4, 5)       198929    0.015918
trx_to_features        : Encoder stat for "title":
codes | trx_count
              cnt  % of total
title                        
[1, 4)    3476871    0.278206
[4, 7)    2264725    0.181215
[7, 10)   1567457    0.125422
[10, 13)  1466772    0.117366
[13, 16)  1227996    0.098260
[16, 19)   992385    0.079407
[19, 22)   706156    0.056504
[22, 25)   596165    0.047703
[25, 29)    73886    0.005912
[29, 45)   125043    0.010005
trx_to_features        : Encoder stat for "world":
codes | trx_count
            cnt  % of total
world                      
[1, 2)  5534978    0.442888
[2, 3)  3543933    0.283572
[3, 4)  3393526    0.271537
[4, 5)    25019    0.002002
trx_to_features        : Encoder stat for "correct":
codes | trx_count
              cnt  % of total
correct                      
[1, 2)   11614642    0.929361
[2, 3)     564598    0.045177
[3, 4)     318216    0.025462
trx_to_features        : Trx count per clients:
len(trx_list) | client_count
                 cnt  % of total
trx_count                       
[1, 860)       14399    0.799944
[860, 1719)     1733    0.096278
[1719, 2578)     732    0.040667
[2578, 3437)     390    0.021667
[3437, 4297)     220    0.012222
[4297, 5156)     131    0.007278
[5156, 6015)      90    0.005000
[6015, 6874)      79    0.004389
[6874, 7734)      45    0.002500
[7734, 58989)    181    0.010056
trx_to_features        : Feature collection in progress ...
trx_to_features        : Feature names: ['event_id', 'game_session', 'event_code', 'game_time', 'title', 'event_type', 'world', 'correct']
trx_to_features        : Prepared features for 18000 clients
<module>               : Encoding col dict saved to: "/mnt/data/ovsov/dltranz/experiments/scenario_bowl2019/data/encoding.p"
split_dataset          : Train size: 17639 clients
split_dataset          : Test size: 361 clients
save_features          : Saved to: "/mnt/data/ovsov/dltranz/experiments/scenario_bowl2019/data/train_trx.p"
save_features          : Saved to: "/mnt/data/ovsov/dltranz/experiments/scenario_bowl2019/data/train.p"
save_features          : Saved to: "/mnt/data/ovsov/dltranz/experiments/scenario_bowl2019/data/test.p"
<module>               : Data collected in 1027 sec (0:17:07.182893)
